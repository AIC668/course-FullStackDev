# 用 LTS
FROM node:20

# 更快的 npm（可选）
RUN corepack enable

WORKDIR /app

# 先拷贝依赖清单，利用缓存
COPY package*.json ./

# 安装依赖（在 dev 环境下会包含 devDependencies）
# 如果你的 package.json 里没有 nodemon，也没关系：我们全局再装一份兜底
RUN npm install && npm install -g nodemon

# 再拷贝源码
COPY . .

# 暴露端口（文档化）
EXPOSE 5000

# 交由 compose 的 command 覆盖启动方式
